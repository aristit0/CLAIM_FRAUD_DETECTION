<!DOCTYPE html>
<html>
<head>
    <title>Claim Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-900 text-white min-h-screen">

<div class="max-w-7xl mx-auto py-10">

    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold">Claim Dashboard</h1>
        <a href="/logout" class="text-red-400 hover:underline">Logout</a>
    </div>

    <!-- SEARCH BAR -->
    <div class="mb-6">
        <input id="searchInput"
               onkeyup="filterTable()"
               placeholder="Search claim ID or patient name..."
               class="w-full p-3 rounded bg-gray-800 text-white outline-none border border-gray-700 focus:ring-2 focus:ring-blue-500">
    </div>

    <!-- CLAIMS TABLE -->
    <div class="overflow-x-auto">
        <table id="claimsTable" class="w-full border-collapse">
            <thead>
                <tr class="text-gray-300 bg-gray-800">
                    <th class="p-3 text-left">Claim ID</th>
                    <th class="p-3 text-left">Patient</th>
                    <th class="p-3 text-left">Visit Date</th>
                    <th class="p-3 text-left">Type</th>
                    <th class="p-3 text-left">Department</th>
                    <th class="p-3 text-left">Total Amount</th>
                    <th class="p-3 text-left">Status</th>
                    <th class="p-3 text-left">Action</th>
                </tr>
            </thead>

            <tbody>
                {% for c in claims %}
                <tr class="border-t border-gray-700 hover:bg-gray-800 transition">
                    <td class="p-3">{{ c.claim_id }}</td>
                    <td class="p-3">{{ c.patient_name }}</td>
                    <td class="p-3">{{ c.visit_date }}</td>
                    <td class="p-3">{{ c.visit_type }}</td>
                    <td class="p-3">{{ c.department }}</td>
                    <td class="p-3">Rp {{ "%.0f"|format(c.total_claim_amount) }}</td>

                    <td class="p-3">
                        {% if c.status == "approved" %}
                            <span class="bg-green-700 text-green-200 px-2 py-1 rounded text-xs">Approved</span>
                        {% elif c.status == "declined" %}
                            <span class="bg-red-700 text-red-200 px-2 py-1 rounded text-xs">Declined</span>
                        {% elif c.status == "manual_review" %}
                            <span class="bg-yellow-700 text-yellow-200 px-2 py-1 rounded text-xs">Manual Review</span>
                        {% elif c.status == "approved_partial" %}
                            <span class="bg-blue-700 text-blue-200 px-2 py-1 rounded text-xs">Partial</span>
                        {% elif c.status == "request_docs" %}
                            <span class="bg-purple-700 text-purple-200 px-2 py-1 rounded text-xs">Request Docs</span>
                        {% else %}
                            <span class="bg-gray-600 text-gray-300 px-2 py-1 rounded text-xs">Pending</span>
                        {% endif %}
                    </td>

                    <td class="p-3">
                        <a href="/review/{{ c.claim_id }}"
                           class="bg-blue-600 px-3 py-1 rounded hover:bg-blue-700 text-white text-sm">
                            Review
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>

        </table>
    </div>
</div>

<script>
function filterTable() {
    let filter = document.getElementById("searchInput").value.toLowerCase();
    let rows = document.querySelectorAll("#claimsTable tbody tr");

    rows.forEach(row => {
        let text = row.innerText.toLowerCase();
        row.style.display = text.includes(filter) ? "" : "none";
    });
}
</script>

</body>
</html>